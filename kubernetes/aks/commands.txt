# Create Resource Group
az group create --name "mt-aks-rg" --location germanywestcentral

# Create SSH Key (in cloud shell)
az sshkey create --name "mt-aks-ssh-key" --resource-group "mt-aks-rg"
ssh-keygen -t rsa -b 4096

# Cluster Deployment
az deployment group create --resource-group "mt-aks-rg" --template-file "main.bicep" --parameters dnsPrefix="mt-aks" linuxAdminUsername="masterthesis" sshRSAPublicKey='ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC0H1m7Q8jtpyjX9c56baTYHP6h6J495vzMdWjsmlmYG9XHCu++KlK2HomEbEFQB8ZD5z43lr3FC4kR4JhmrloRx8rKlJ1Lfi/YTRiYy0jg5FQy2yBfVCoT38fM3/51KSEoZi2sOdtKTT9vd3o/fL59aOKD04J5vYFK+J7yU4GFuTxejn011ctdE3ZOnnPOFrboQCIrTfF1rh3vtn4+ah/oTmwOIIFwP9sOraBOc4gD6bMkRjtgWhgnvR9rIGVHBcNtOpJB8fsglmogKGU+ir4gvJrE5k+UXywlqx5IshT/LKRdj8MsfrxUVRyXbyW8P1C/Vqan8r3ZZ4dis4fD04cE60rdTm/+t2yflFbZR1MCwgWVEBxNKgSrLK3j72O0CK0Bf1wvmvT+KYlIFpZl8is0h8225h9PK0xf++ZjC15UXjiX5+vRP8Zks5ua4JO3scXe/cWA6bOdS9/7iU3+r86dv+KpwdZsn0j3lQZPj3DiOptEEjWRIjEoMwIY+sMTLjU= generated-by-azure'

# Configuring kubectl
az aks get-credentials --resource-group "mt-aks-rg" --name "aks101cluster"

kubectl apply -f api.yaml

kubectl get service mt-aks-api

# Cleanup
az group delete --name "mt-aks-rg" --yes --no-wait